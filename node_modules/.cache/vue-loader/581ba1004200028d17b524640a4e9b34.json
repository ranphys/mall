{"remainingRequest":"C:\\Users\\明希\\Desktop\\前端\\案例\\vuejs\\mall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\明希\\Desktop\\前端\\案例\\vuejs\\mall\\src\\views\\detail\\Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\明希\\Desktop\\前端\\案例\\vuejs\\mall\\src\\views\\detail\\Detail.vue","mtime":1624530696881},{"path":"C:\\Users\\明希\\Desktop\\前端\\案例\\vuejs\\mall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\明希\\Desktop\\前端\\案例\\vuejs\\mall\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\明希\\Desktop\\前端\\案例\\vuejs\\mall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\明希\\Desktop\\前端\\案例\\vuejs\\mall\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport DetailNav from './childcomps/DetailNav.vue'\r\nimport DetailSwiper from './childcomps/DetailSwiper.vue'\r\nimport DetailBaseInfo from './childcomps/DetailBaseInfo.vue'\r\nimport DetailShopInfo from './childcomps/DetailShopInfo.vue'\r\nimport DetailGoodsInfo from './childcomps/DetailGoodsInfo.vue'\r\nimport DetailParams from './childcomps/DetailParams.vue'\r\nimport DetailRate from './childcomps/DetailRate.vue'\r\nimport DetailBottomNav from './childcomps/DetailBottomNav.vue'\r\n\r\nimport Scroll from '../../components/common/scroll/Scroll.vue'\r\n\r\nimport {getDetail,Goods,Shop} from '@/network/detail'\r\n\r\nimport {debounce} from \"@/common/utils.js\"\r\nimport {backTopMixin} from '@/common/mixin.js'\r\n\r\nimport{ mapActions} from 'vuex'\r\nexport default {\r\n  name: 'Detail',\r\n  mixins: [backTopMixin],\r\n  data() {\r\n      return {\r\n          id: null,\r\n          swiperImg: [],\r\n          goods: {},\r\n          shop: {},\r\n          img: {},\r\n          detailParams: {},\r\n          rate:{},\r\n          scrollY:[],\r\n          getScrollY:null,\r\n          currentIndex: 0\r\n        \r\n      }\r\n  },\r\n  methods: {\r\n      ...mapActions(['addCart']),\r\n      addToCart() {\r\n          const product = {}\r\n          console.log(this.goods);\r\n          product.img = this.swiperImg[0]\r\n          product.title = this.goods.title\r\n          product.price = this.goods.lowPrice\r\n          product.id = this.id\r\n          this.addCart(product).then(res=>console.log(res))\r\n          this.$toast(res,1500)\r\n      },\r\n      itemClick(index) {\r\n          this.$refs.scroll.scrollTo(0,-this.scrollY[index],100)\r\n      },\r\n      imageLoad() {\r\n         this.getScrollY()\r\n\r\n         \r\n      },\r\n      scroll(position) {\r\n          const positionY = -position.y\r\n          let length = this.scrollY.length\r\n          for(let i = 0;i<length-1;i++) {\r\n              if(this.currentIndex!=i &&(positionY >= this.scrollY[i]&&positionY< this.scrollY[i+1])\r\n              ) {\r\n                  this.currentIndex = i\r\n                  console.log(this.currentIndex);\r\n                  this.$refs.nav.currentIndex = this.currentIndex\r\n              }\r\n          }\r\n          this.isShow = -position.y > 1000\r\n      }\r\n  },\r\n  components:{\r\n      DetailNav,\r\n      DetailSwiper,\r\n      DetailBaseInfo,\r\n      DetailParams,\r\n      DetailRate,\r\n      DetailBottomNav,\r\n      Scroll,\r\n      DetailShopInfo,\r\n      DetailGoodsInfo\r\n  },\r\n  created() {\r\n      this.id = this.$route.params.id\r\n      getDetail(this.id).then(res => {\r\n          this.swiperImg = res[0].swiper\r\n          this.goods = new Goods(res[0].itemInfo,res[0].columns,res[0].services)\r\n          this.shop = new Shop(res[0].shopInfo)\r\n          this.img = res[0].img\r\n          this.detailParams = res[0].params\r\n          if(res[0].cRate!=0){\r\n              this.rate = res[0].rate\r\n          }\r\n      })\r\n      this.getScrollY = debounce(() =>{\r\n              this.scrollY = []\r\n          this.scrollY.push(0),\r\n          this.scrollY.push(this.$refs.params.$el.offsetTop)\r\n          this.scrollY.push(this.$refs.rate.$el.offsetTop)\r\n          this.scrollY.push(this.$refs.recommend.$el.offsetTop)\r\n          this.scrollY.push(Number.MAX_VALUE)\r\n          console.log(this.scrollY);\r\n          }, 100)\r\n  }\r\n}\r\n",{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\r\n  <div id=\"detail\">\r\n      <detail-nav class=\"nav\" @itemClick='itemClick'  ref=\"nav\"></detail-nav>\r\n      <scroll class=\"content\" ref=\"scroll\" :probe-type=\"3\" @scroll=\"scroll\">\r\n          <detail-swiper :swiper-img=\"swiperImg\"></detail-swiper>\r\n          <detail-base-info :goods=\"goods\"></detail-base-info>\r\n          <detail-shop-info :shop=\"shop\"></detail-shop-info>\r\n          <detail-goods-info :img=\"img\"  @imageLoad = \"imageLoad\"></detail-goods-info>\r\n          <detail-params :detail-params = \"detailParams\" ref=\"params\"></detail-params>\r\n          <detail-rate :rate=\"rate\"  ref=\"rate\"></detail-rate>\r\n          <detail-rate :rate=\"rate\"  ref=\"recommend\"></detail-rate>\r\n      </scroll>\r\n      <detail-bottom-nav @addToCart=\"addToCart\"></detail-bottom-nav>\r\n      <back-top @click.native=\"backClick\" v-show=\"isShow\"></back-top>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DetailNav from './childcomps/DetailNav.vue'\r\nimport DetailSwiper from './childcomps/DetailSwiper.vue'\r\nimport DetailBaseInfo from './childcomps/DetailBaseInfo.vue'\r\nimport DetailShopInfo from './childcomps/DetailShopInfo.vue'\r\nimport DetailGoodsInfo from './childcomps/DetailGoodsInfo.vue'\r\nimport DetailParams from './childcomps/DetailParams.vue'\r\nimport DetailRate from './childcomps/DetailRate.vue'\r\nimport DetailBottomNav from './childcomps/DetailBottomNav.vue'\r\n\r\nimport Scroll from '../../components/common/scroll/Scroll.vue'\r\n\r\nimport {getDetail,Goods,Shop} from '@/network/detail'\r\n\r\nimport {debounce} from \"@/common/utils.js\"\r\nimport {backTopMixin} from '@/common/mixin.js'\r\n\r\nimport{ mapActions} from 'vuex'\r\nexport default {\r\n  name: 'Detail',\r\n  mixins: [backTopMixin],\r\n  data() {\r\n      return {\r\n          id: null,\r\n          swiperImg: [],\r\n          goods: {},\r\n          shop: {},\r\n          img: {},\r\n          detailParams: {},\r\n          rate:{},\r\n          scrollY:[],\r\n          getScrollY:null,\r\n          currentIndex: 0\r\n        \r\n      }\r\n  },\r\n  methods: {\r\n      ...mapActions(['addCart']),\r\n      addToCart() {\r\n          const product = {}\r\n          console.log(this.goods);\r\n          product.img = this.swiperImg[0]\r\n          product.title = this.goods.title\r\n          product.price = this.goods.lowPrice\r\n          product.id = this.id\r\n          this.addCart(product).then(res=>console.log(res))\r\n          this.$toast(res,1500)\r\n      },\r\n      itemClick(index) {\r\n          this.$refs.scroll.scrollTo(0,-this.scrollY[index],100)\r\n      },\r\n      imageLoad() {\r\n         this.getScrollY()\r\n\r\n         \r\n      },\r\n      scroll(position) {\r\n          const positionY = -position.y\r\n          let length = this.scrollY.length\r\n          for(let i = 0;i<length-1;i++) {\r\n              if(this.currentIndex!=i &&(positionY >= this.scrollY[i]&&positionY< this.scrollY[i+1])\r\n              ) {\r\n                  this.currentIndex = i\r\n                  console.log(this.currentIndex);\r\n                  this.$refs.nav.currentIndex = this.currentIndex\r\n              }\r\n          }\r\n          this.isShow = -position.y > 1000\r\n      }\r\n  },\r\n  components:{\r\n      DetailNav,\r\n      DetailSwiper,\r\n      DetailBaseInfo,\r\n      DetailParams,\r\n      DetailRate,\r\n      DetailBottomNav,\r\n      Scroll,\r\n      DetailShopInfo,\r\n      DetailGoodsInfo\r\n  },\r\n  created() {\r\n      this.id = this.$route.params.id\r\n      getDetail(this.id).then(res => {\r\n          this.swiperImg = res[0].swiper\r\n          this.goods = new Goods(res[0].itemInfo,res[0].columns,res[0].services)\r\n          this.shop = new Shop(res[0].shopInfo)\r\n          this.img = res[0].img\r\n          this.detailParams = res[0].params\r\n          if(res[0].cRate!=0){\r\n              this.rate = res[0].rate\r\n          }\r\n      })\r\n      this.getScrollY = debounce(() =>{\r\n              this.scrollY = []\r\n          this.scrollY.push(0),\r\n          this.scrollY.push(this.$refs.params.$el.offsetTop)\r\n          this.scrollY.push(this.$refs.rate.$el.offsetTop)\r\n          this.scrollY.push(this.$refs.recommend.$el.offsetTop)\r\n          this.scrollY.push(Number.MAX_VALUE)\r\n          console.log(this.scrollY);\r\n          }, 100)\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n    #detail {\r\n        position: relative;\r\n        height: 100vh;\r\n        z-index: 9;\r\n        background-color: #fff;\r\n    }\r\n    .nav {\r\n        position: relative;\r\n        z-index: 9;\r\n        background-color: #fff;\r\n    }\r\n    .content {\r\n        position: absolute;\r\n        top: 44px;\r\n        bottom: 49px;\r\n        left: 0;\r\n        right: 0;\r\n    }\r\n</style>"]}]}